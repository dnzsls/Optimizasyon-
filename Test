"""
FONKSÄ°YON 3: ASA (Average Speed to Answer)
Ortalama kaÃ§ saniyede yanÄ±t verileceÄŸini hesaplar
"""

def erlang_c(agents, traffic):
    """Ã–nceki fonksiyon - bekleme olasÄ±lÄ±ÄŸÄ±"""
    if agents <= traffic or agents == 0:
        return 1.0
    
    erlang_b = traffic / agents
    for i in range(2, int(agents) + 1):
        erlang_b = (traffic * erlang_b) / (i + traffic * erlang_b)
    
    erlang_c_val = erlang_b / (1 - (traffic / agents) * (1 - erlang_b))
    return min(erlang_c_val, 1.0)


def calculate_asa(agents, traffic, aht):
    """
    ASA: Ortalama kaÃ§ saniyede yanÄ±t veriliyor?
    
    FormÃ¼l mantÄ±ÄŸÄ±:
    ASA = (Bekleme_OlasÄ±lÄ±ÄŸÄ± Ã— AHT) / (Fazla_Agent) Ã— 60
    
    Parametreler:
    - agents: Agent sayÄ±sÄ±
    - traffic: Trafik (Erlang)
    - aht: Average Handle Time (saniye)
    
    DÃ¶nÃ¼ÅŸ:
    - ASA (saniye)
    """
    if agents <= traffic:
        return 999  # Yetersiz agent = Ã§ok uzun bekleme
    
    # Bekleme olasÄ±lÄ±ÄŸÄ± (Fonksiyon 2)
    ec = erlang_c(agents, traffic)
    
    # ASA hesapla
    # (ec Ã— AHT_dakika) / (fazla_agent) Ã— 60
    asa = (ec * (aht / 60)) / (agents - traffic) * 60
    
    return asa


# TEST EDELÄ°M
if __name__ == '__main__':
    print("=" * 60)
    print("FONKSÄ°YON 3: ASA HESAPLAMA")
    print("=" * 60)
    
    # Sabit deÄŸerler
    traffic = 5.0  # 5 Erlang
    aht = 180      # 180 saniye (3 dakika)
    
    print(f"\nSabit:")
    print(f"  Traffic: {traffic} Erlang")
    print(f"  AHT: {aht} saniye")
    print(f"\nSoru: FarklÄ± agent sayÄ±larÄ±yla ASA ne?\n")
    
    # Test 1: 6 agent
    agents1 = 6
    asa1 = calculate_asa(agents1, traffic, aht)
    print(f"Test 1: {agents1} agent")
    print(f"  Fazla agent: {agents1 - traffic}")
    print(f"  ASA: {asa1:.1f} saniye")
    print(f"  Yorum: Ã‡ok uzun! âŒ")
    
    # Test 2: 7 agent
    agents2 = 7
    asa2 = calculate_asa(agents2, traffic, aht)
    print(f"\nTest 2: {agents2} agent")
    print(f"  Fazla agent: {agents2 - traffic}")
    print(f"  ASA: {asa2:.1f} saniye")
    print(f"  Yorum: Hala uzun")
    
    # Test 3: 8 agent
    agents3 = 8
    asa3 = calculate_asa(agents3, traffic, aht)
    print(f"\nTest 3: {agents3} agent")
    print(f"  Fazla agent: {agents3 - traffic}")
    print(f"  ASA: {asa3:.1f} saniye")
    print(f"  Yorum: 30 sn hedefine yaklaÅŸtÄ± âœ“")
    
    # Test 4: 10 agent
    agents4 = 10
    asa4 = calculate_asa(agents4, traffic, aht)
    print(f"\nTest 4: {agents4} agent")
    print(f"  Fazla agent: {agents4 - traffic}")
    print(f"  ASA: {asa4:.1f} saniye")
    print(f"  Yorum: Ã‡ok iyi! Hedef 30 sn altÄ±nda ğŸ¯")
    
    print("\n" + "=" * 60)
    print("ğŸ’¡ Ã–ÄRENME:")
    print("  - Fazla agent az â†’ ASA yÃ¼ksek (uzun bekleme)")
    print("  - Fazla agent Ã§ok â†’ ASA dÃ¼ÅŸÃ¼k (kÄ±sa bekleme)")
    print("  - Hedef: 30 saniye ASA iÃ§in kaÃ§ agent gerek?")
    print("=" * 60)
    print("\nâ¡ï¸ Sonraki fonksiyon: Hedef ASA iÃ§in agent sayÄ±sÄ± bulma")
